import{r as p,u as y,j as e}from"./index-UfRKJNI8.js";const f=t=>t.startsWith("4")?"visa":t.startsWith("5")?"mastercard":"",x=t=>{const{number:a,name:n,expiry:c,cvc:m}=t,s={},i=a.replace(/\s/g,"");let h=0,u=!1;for(let o=i.length-1;o>=0;o--){let r=parseInt(i.charAt(o));u&&(r*=2)>9&&(r-=9),h+=r,u=!u}if(i.length>0&&h%10!==0?s.number="Invalid card number":i.length===0&&(s.number="Card number is required"),n||(s.name="Name is required"),!c)s.expiry="Expiry date is required";else{const[o,r]=c.split("/");if(!o||!r||o.length!==2||r.length!==2)s.expiry="Invalid date format (MM/YY)";else{const d=new Date(`20${r}`,o-1),l=new Date;d.setHours(23,59,59,999),l.setHours(0,0,0,0),d<l&&(s.expiry="Card has expired")}}return m?m.length<3&&(s.cvc="CVC must be at least 3 digits"):s.cvc="CVC is required",s},b={paymentMethod:"visa",cardInfo:{number:"",name:"",expiry:"",cvc:""},errors:{},cardType:""};function v(t,a){switch(a.type){case"SET_FIELD_VALUE":return{...t,cardInfo:{...t.cardInfo,[a.payload.name]:a.payload.value}};case"SET_PAYMENT_METHOD":return{...t,paymentMethod:a.payload};case"SET_ERRORS":return{...t,errors:a.payload};case"SET_CARD_TYPE":return{...t,cardType:a.payload};default:return t}}const N=()=>{const[t,a]=p.useReducer(v,b),{paymentMethod:n,cardInfo:c,errors:m,cardType:s}=t,i=y();return p.useEffect(()=>{if(n==="bitcoin")a({type:"SET_ERRORS",payload:{}});else{const d=x(c);a({type:"SET_ERRORS",payload:d})}const r=f(c.number);r!==s&&a({type:"SET_CARD_TYPE",payload:r})},[n,c,s]),{paymentMethod:n,cardInfo:c,errors:m,cardType:s,handlePayment:()=>{if(n==="bitcoin"){i("/checkout-success");return}const r=x(c);a({type:"SET_ERRORS",payload:r}),Object.keys(r).length===0&&i("/checkout-success")},handleCardInfoChange:r=>{let{name:d,value:l}=r.target;d==="number"&&(l=l.replace(/\D/g,"").replace(/(.{4})/g,"$1 ").trim()),d==="expiry"&&(l=l.replace(/\D/g,"").replace(/(.{2})/,"$1/").trim()),a({type:"SET_FIELD_VALUE",payload:{name:d,value:l}})},setPaymentMethod:r=>{a({type:"SET_PAYMENT_METHOD",payload:r})}}},j=()=>{const{paymentMethod:t,cardInfo:a,errors:n,cardType:c,handlePayment:m,handleCardInfoChange:s,setPaymentMethod:i}=N(),h=t!=="bitcoin"&&(Object.values(n).some(u=>u)||!a.number||!a.name||!a.expiry||!a.cvc);return e.jsx("div",{className:"checkout-page",children:e.jsxs("div",{className:"neumo-card checkout-card",children:[e.jsx("h4",{className:"checkout-card__title text-2xl font-bold",children:"Choose a payment method"}),e.jsxs("div",{className:"checkout-card__payment-methods",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"visa",type:"radio",name:"paymentMethod",className:"hidden",checked:t==="visa",onChange:()=>i("visa")}),e.jsx("label",{htmlFor:"visa",className:`neumo-button w-full text-center p-3 cursor-pointer ${t==="visa"?"neumo-button--pressed":""}`,children:"Visa"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"mastercard",type:"radio",name:"paymentMethod",className:"hidden",checked:t==="mastercard",onChange:()=>i("mastercard")}),e.jsx("label",{htmlFor:"mastercard",className:`neumo-button w-full text-center p-3 cursor-pointer ${t==="mastercard"?"neumo-button--pressed":""}`,children:"Mastercard"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"bitcoin",type:"radio",name:"paymentMethod",className:"hidden",checked:t==="bitcoin",onChange:()=>i("bitcoin")}),e.jsx("label",{htmlFor:"bitcoin",className:`neumo-button w-full text-center p-3 cursor-pointer ${t==="bitcoin"?"neumo-button--pressed":""}`,children:"Bitcoin"})]})]}),(t==="visa"||t==="mastercard")&&e.jsxs("div",{className:"checkout-card__form",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{placeholder:"Card Number",className:"neumo-input p-3",name:"number",value:a.number,onChange:s,maxLength:19}),e.jsx("i",{className:`absolute right-4 top-1/2 -translate-y-1/2 text-2xl ${c==="visa"?"fab fa-cc-visa":c==="mastercard"?"fab fa-cc-mastercard":""}`}),n.number&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.number})]}),e.jsxs("div",{children:[e.jsx("input",{placeholder:"Cardholder Name",className:"neumo-input p-3",name:"name",value:a.name,onChange:s}),n.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),e.jsxs("div",{className:"checkout-card__form-row",children:[e.jsxs("div",{className:"checkout-card__form-col--half",children:[e.jsx("input",{placeholder:"Expiry (MM/YY)",className:"neumo-input p-3",name:"expiry",value:a.expiry,onChange:s,maxLength:5}),n.expiry&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.expiry})]}),e.jsxs("div",{className:"checkout-card__form-col--half",children:[e.jsx("input",{placeholder:"CVC",className:"neumo-input p-3",name:"cvc",value:a.cvc,onChange:s,maxLength:4}),n.cvc&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.cvc})]})]})]}),e.jsx("button",{onClick:m,className:"neumo-button checkout-card__pay-button bg-green-500 text-white disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:"Pay Now"})]})})};export{j as default};
