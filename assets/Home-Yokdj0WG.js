import{r as o,C as v,j as e,a,P as n,R as T}from"./index-BjDJNJU4.js";const b=({product:s,open:r,onClose:i})=>{const{addToCart:t}=o.useContext(v),[l,d]=o.useState(1),g=()=>{t(s,l),i()},m=()=>{l<s.stock&&d(l+1)},c=()=>{l>1&&d(l-1)};return e.jsxs(a.Dialog,{open:r,handler:i,children:[e.jsx(a.DialogHeader,{children:e.jsx(a.Typography,{variant:"h5",color:"blue-gray",children:s==null?void 0:s.title})}),e.jsxs(a.DialogBody,{divider:!0,children:[e.jsx("img",{src:s==null?void 0:s.thumbnail,alt:s==null?void 0:s.title,className:"product-modal__image"}),e.jsx(a.Typography,{className:"product-modal__description",children:s==null?void 0:s.description}),e.jsxs(a.Typography,{variant:"h6",color:"blue-gray",className:"product-modal__price",children:["Price: $ ",s==null?void 0:s.price]}),e.jsxs(a.Typography,{variant:"h6",color:"blue-gray",className:"product-modal__stock",children:["Stock: ",s==null?void 0:s.stock]})]}),e.jsxs(a.DialogFooter,{className:"product-modal__footer",children:[e.jsxs("div",{className:"product-modal__quantity-controls",children:[e.jsx(a.Button,{onClick:c,disabled:l===1,children:"-"}),e.jsx(a.Typography,{className:"product-modal__quantity-value",children:l}),e.jsx(a.Button,{onClick:m,disabled:l>=s.stock,children:"+"})]}),e.jsx(a.Button,{variant:"gradient",color:"green",onClick:g,disabled:s.stock===0,children:e.jsx("span",{children:"Add to Cart"})})]})]})};b.propTypes={product:n.object.isRequired,open:n.bool.isRequired,onClose:n.func.isRequired};const y=T.memo(({product:s})=>{const[r,i]=o.useState(!1),t=()=>i(!r);return e.jsxs(e.Fragment,{children:[e.jsxs(a.Card,{className:"product-card",children:[e.jsx(a.CardHeader,{className:"product-card__header",shadow:!1,floated:!1,children:e.jsx("img",{className:"product-card__image",src:s==null?void 0:s.thumbnail,alt:s==null?void 0:s.title})}),e.jsxs(a.CardBody,{className:"product-card__body",children:[e.jsx(a.Typography,{variant:"h5",color:"blue-gray",className:"product-card__title",children:s==null?void 0:s.title}),e.jsx(a.Typography,{variant:"small",color:"gray",className:"product-card__description",children:s==null?void 0:s.description})]}),e.jsx(a.CardFooter,{className:"product-card__footer",children:e.jsxs("div",{className:"product-card__footer-content",children:[e.jsxs(a.Typography,{color:"blue-gray",className:"product-card__price",children:["$ ",s==null?void 0:s.price]}),s.stock>0?e.jsx("button",{onClick:t,className:"product-card__details-button",children:"Details"}):e.jsx(a.Typography,{color:"red",className:"product-card__out-of-stock",children:"Out of stock"})]})})]}),s.stock>0&&e.jsx(b,{product:s,open:r,onClose:t})]})});y.displayName="Product";y.propTypes={product:n.shape({id:n.number.isRequired,thumbnail:n.string.isRequired,title:n.string.isRequired,price:n.number.isRequired,description:n.string.isRequired,stock:n.number.isRequired}).isRequired};const p=({products:s})=>e.jsx("div",{className:"product-grid",children:s.map(r=>e.jsx(y,{product:r},r.id))});p.propTypes={products:n.array.isRequired};const w="https://dummyjson.com/products",_=20,P=async s=>{const r=(s-1)*_,i=`${w}?limit=${_}&skip=${r}`,t=await fetch(i);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()},R=()=>{const[s,r]=o.useState([]),[i,t]=o.useState(1),[l,d]=o.useState(!0),[g,m]=o.useState(null),[c,N]=o.useState(!0);o.useEffect(()=>{(async()=>{d(!0),m(null);try{const h=await P(i);r(j=>{const k=new Set(j.map(u=>u.id)),C=h.products.filter(u=>!k.has(u.id));return[...j,...C]}),s.length+h.products.length>=h.total&&N(!1)}catch(h){m(h.message||"An unexpected error occurred")}finally{d(!1)}})()},[i,s.length]);const f=o.useCallback(()=>{c&&!l&&t(x=>x+1)},[c,l]);return{products:s,error:g,loading:l,initialLoading:i===1&&l,hasMore:c,loadMore:f}},q=()=>e.jsxs(a.Card,{className:"w-full max-w-sm mx-auto bg-white dark:bg-dark-card rounded-lg shadow-md overflow-hidden",children:[e.jsx(a.CardHeader,{shadow:!1,floated:!1,className:"h-56",children:e.jsx("div",{className:"h-full w-full bg-gray-300 dark:bg-gray-700 animate-pulse"})}),e.jsxs(a.CardBody,{className:"p-4",children:[e.jsx("div",{className:"h-6 w-3/4 mb-2 bg-gray-300 dark:bg-gray-700 animate-pulse rounded"}),e.jsx("div",{className:"h-4 w-full bg-gray-300 dark:bg-gray-700 animate-pulse rounded"})]}),e.jsx(a.CardFooter,{className:"p-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-6 w-1/4 bg-gray-300 dark:bg-gray-700 animate-pulse rounded"}),e.jsx("div",{className:"h-8 w-1/4 bg-gray-300 dark:bg-gray-700 animate-pulse rounded"})]})})]}),S=()=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8",children:Array.from({length:8}).map((s,r)=>e.jsx(q,{},r))}),D=()=>{const{products:s,initialLoading:r,loading:i,error:t,loadMore:l,hasMore:d}=R();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"home__header",children:[e.jsx(a.Typography,{variant:"h1",color:"blue-gray",className:"home__title",children:"Lista de Productos"}),e.jsx(a.Typography,{variant:"lead",color:"blue-gray",className:"home__subtitle",children:"React VITE + Tailwind CSS + DummyJSON API"})]}),r&&e.jsx(S,{}),t&&e.jsx("p",{className:"home__error",children:t}),!r&&!t&&s.length===0&&e.jsx("p",{className:"home__empty",children:"No se encontraron productos."}),!r&&s.length>0&&e.jsxs("div",{className:"home",children:[e.jsx(p,{products:s}),e.jsxs("div",{className:"home__pagination",children:[d&&e.jsx(a.Button,{variant:"outlined",onClick:l,disabled:i,"aria-label":"Cargar más productos",children:i?"Cargando...":"Ver más"}),!d&&e.jsx("p",{children:"Has alcanzado el final de la lista."})]})]})]})};export{D as default};
